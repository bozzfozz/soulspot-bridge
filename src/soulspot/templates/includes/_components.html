{# 
  Hey future me - Legacy UI Components (for backwards compatibility)
  
  Most of these are superseded by:
  - includes/macros.html (new design system macros)
  - CSS classes in /static/new-ui/css/components.css
  
  Keep these for templates not yet migrated.
#}

{# Alert/Notification Component #}
{% macro alert(type='info', title='', message='', icon=true, dismissible=false) %}
{% set type_map = {'danger': 'error', 'success': 'success', 'warning': 'warning', 'info': 'info'} %}
{% set icon_map = {'success': 'bi-check-circle', 'warning': 'bi-exclamation-triangle', 'error': 'bi-x-circle', 'danger': 'bi-x-circle', 'info': 'bi-info-circle'} %}
<div class="alert alert-{{ type_map.get(type, type) }}" role="alert" style="display: flex; align-items: flex-start; gap: var(--space-3); padding: var(--space-4); border-radius: var(--radius-lg); position: relative;">
    {% if icon %}
    <i class="bi {{ icon_map.get(type, 'bi-info-circle') }}" style="margin-top: 2px;"></i>
    {% endif %}
    <div style="flex: 1;">
        {% if title %}
        <div style="font-weight: var(--font-weight-bold); margin-bottom: var(--space-1);">{{ title }}</div>
        {% endif %}
        {{ message }}
    </div>
    {% if dismissible %}
    <button style="position: absolute; top: var(--space-3); right: var(--space-3); background: none; border: none; cursor: pointer; color: inherit; opacity: 0.6;" 
            onclick="this.parentElement.remove()"
            aria-label="Dismiss alert">
        <i class="bi bi-x"></i>
    </button>
    {% endif %}
</div>
{% endmacro %}

{# Badge Component #}
{% macro badge(text, type='neutral', pulse=false) %}
{% set type_map = {'neutral': 'default', 'success': 'success', 'warning': 'warning', 'danger': 'error', 'info': 'info', 'primary': 'primary'} %}
<span class="badge badge-{{ type_map.get(type, 'default') }}">
    {{ text }}
</span>
{% endmacro %}

{# Progress Bar #}
{% macro progress_bar(value, max=100, label='', show_percentage=true, color='primary') %}
{% set percent = (value / max * 100)|round|int %}
<div style="width: 100%;" role="progressbar" aria-valuenow="{{ value }}" aria-valuemin="0" aria-valuemax="{{ max }}">
    {% if label or show_percentage %}
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-1);">
        {% if label %}
        <span style="font-size: var(--font-size-sm); font-weight: var(--font-weight-medium);">{{ label }}</span>
        {% endif %}
        {% if show_percentage %}
        <span style="font-size: var(--font-size-sm); color: var(--text-muted);">{{ percent }}%</span>
        {% endif %}
    </div>
    {% endif %}
    <div style="width: 100%; background: var(--bg-tertiary); border-radius: 9999px; height: 8px; overflow: hidden;">
        <div style="background: var(--accent-primary); height: 100%; border-radius: 9999px; transition: width 0.3s ease; width: {{ percent }}%;"></div>
    </div>
</div>
{% endmacro %}

{# Breadcrumb Navigation #}
{% macro breadcrumb(items) %}
<nav style="margin-bottom: var(--space-6);" aria-label="Breadcrumb">
    <ol style="display: flex; align-items: center; gap: var(--space-2); list-style: none; font-size: var(--font-size-sm);">
        {% for item in items %}
        <li style="display: flex; align-items: center;">
            {% if not loop.first %}
            <i class="bi bi-chevron-right" style="color: var(--text-muted); font-size: 0.625rem; margin: 0 var(--space-2);"></i>
            {% endif %}
            {% if item.href and not loop.last %}
            <a href="{{ item.href }}" style="color: var(--accent-primary);">{{ item.text }}</a>
            {% else %}
            <span style="color: {% if loop.last %}var(--text-primary){% else %}var(--text-muted){% endif %}; {% if loop.last %}font-weight: var(--font-weight-medium);{% endif %}" {% if loop.last %}aria-current="page"{% endif %}>
                {{ item.text }}
            </span>
            {% endif %}
        </li>
        {% endfor %}
    </ol>
</nav>
{% endmacro %}

{# Empty State #}
{% macro empty_state(icon, title, description, action_text='', action_href='') %}
<div class="card" style="padding: var(--space-12); text-align: center;">
    <div style="margin-bottom: var(--space-4);">{{ icon|safe }}</div>
    <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-medium); margin-bottom: var(--space-2);">{{ title }}</h3>
    <p style="color: var(--text-muted); margin-bottom: var(--space-6);">{{ description }}</p>
    {% if action_text and action_href %}
    <a href="{{ action_href }}" class="btn btn-primary">{{ action_text }}</a>
    {% endif %}
</div>
{% endmacro %}

{# Status Indicator #}
{% macro status_indicator(status) %}
{% set status_config = {
    'success': {'color': 'success', 'icon': 'bi-check-circle', 'label': 'Success'},
    'pending': {'color': 'warning', 'icon': 'bi-clock', 'label': 'Pending'},
    'queued': {'color': 'info', 'icon': 'bi-list-ul', 'label': 'Queued'},
    'downloading': {'color': 'primary', 'icon': 'bi-download', 'label': 'Downloading'},
    'completed': {'color': 'success', 'icon': 'bi-check-circle', 'label': 'Completed'},
    'failed': {'color': 'error', 'icon': 'bi-x-circle', 'label': 'Failed'},
    'cancelled': {'color': 'default', 'icon': 'bi-slash-circle', 'label': 'Cancelled'}
} %}
{% set config = status_config.get(status, {'color': 'default', 'icon': 'bi-circle', 'label': status|capitalize}) %}
<span class="badge badge-{{ config.color }}">
    <i class="bi {{ config.icon }}"></i> {{ config.label }}
</span>
{% endmacro %}

{# Priority Badge #}
{% macro priority_badge(priority) %}
{% if priority == 0 %}
<span class="badge badge-error" title="High Priority">P0</span>
{% elif priority == 1 %}
<span class="badge badge-warning" title="Medium Priority">P1</span>
{% elif priority == 2 %}
<span class="badge badge-info" title="Low Priority">P2</span>
{% else %}
<span class="badge badge-default" title="Priority {{ priority }}">P{{ priority }}</span>
{% endif %}
{% endmacro %}

{# Pagination Component #}
{% macro pagination(current_page, total_pages, base_url) %}
{% if total_pages > 1 %}
<nav style="display: flex; justify-content: center; align-items: center; gap: var(--space-2); margin-top: var(--space-6);" aria-label="Pagination">
    {% if current_page > 1 %}
    <a href="{{ base_url }}?page={{ current_page - 1 }}" class="btn btn-outline btn-sm" aria-label="Previous page">
        <i class="bi bi-chevron-left"></i> Previous
    </a>
    {% endif %}
    
    <div style="display: flex; gap: var(--space-1);">
        {% for page in range(1, total_pages + 1) %}
        {% if page == current_page %}
        <span class="btn btn-primary btn-sm" aria-current="page">{{ page }}</span>
        {% elif page == 1 or page == total_pages or (page >= current_page - 2 and page <= current_page + 2) %}
        <a href="{{ base_url }}?page={{ page }}" class="btn btn-outline btn-sm" aria-label="Go to page {{ page }}">{{ page }}</a>
        {% elif page == 2 or page == total_pages - 1 %}
        <span style="padding: 0 var(--space-2); color: var(--text-muted);">...</span>
        {% endif %}
        {% endfor %}
    </div>
    
    {% if current_page < total_pages %}
    <a href="{{ base_url }}?page={{ current_page + 1 }}" class="btn btn-outline btn-sm" aria-label="Next page">
        Next <i class="bi bi-chevron-right"></i>
    </a>
    {% endif %}
</nav>
{% endif %}
{% endmacro %}
