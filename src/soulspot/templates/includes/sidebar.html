{# Hey future me - this is the sidebar navigation for the new UI. Uses request.url.path for active state highlighting.
   The queue_count variable should be passed from the router for badge display. The user variable is for avatar display.
   Keep this in sync with the routes in ui.py - if you add a new page, add a sidebar link here!
   
   STRUKTUR-KONZEPT (Nov 2025):
   - Main: Dashboard, Search (globale Einstiegspunkte)
   - Spotify: Alles was von Spotify kommt (online, cloud)
   - Local Library: Alles was heruntergeladen/lokal ist
   - Downloads: Queue, aktive Transfers
   - System: Settings, Dev-Tools
#}

<!-- Sidebar -->
<aside class="app-sidebar" id="sidebar">
    <!-- Sidebar Header -->
    <div class="sidebar-header">
        <a href="/" class="sidebar-logo">
            <i class="fa-solid fa-music sidebar-logo-icon"></i>
            <span class="sidebar-logo-text">SoulSpot</span>
        </a>
    </div>

    <!-- Sidebar Navigation -->
    <nav class="sidebar-nav">
        <!-- Main Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Main</div>
            <a href="/" class="sidebar-item {% if request.url.path == '/' or request.url.path == '/dashboard' %}active{% endif %}">
                <i class="fa-solid fa-home sidebar-item-icon"></i>
                <span class="sidebar-item-text">Dashboard</span>
            </a>
            <a href="/search" class="sidebar-item {% if request.url.path == '/search' %}active{% endif %}">
                <i class="fa-solid fa-search sidebar-item-icon"></i>
                <span class="sidebar-item-text">Search</span>
            </a>
        </div>

        <!-- Spotify Section (Online/Cloud) -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">
                <i class="fa-brands fa-spotify" style="color: #1DB954; margin-right: 6px;"></i>Spotify
            </div>
            <a href="/playlists" class="sidebar-item {% if '/playlists' in request.url.path and '/import' not in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-list sidebar-item-icon"></i>
                <span class="sidebar-item-text">Playlists</span>
            </a>
            <a href="/spotify/artists" class="sidebar-item {% if '/spotify/artists' in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-heart sidebar-item-icon"></i>
                <span class="sidebar-item-text">Followed Artists</span>
            </a>
            <a href="/playlists/import" class="sidebar-item {% if '/playlists/import' in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-cloud-arrow-down sidebar-item-icon"></i>
                <span class="sidebar-item-text">Import</span>
            </a>
        </div>

        <!-- Local Library Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">
                <i class="fa-solid fa-folder-open" style="color: var(--accent-primary); margin-right: 6px;"></i>Library
            </div>
            <a href="/library/import" class="sidebar-item {% if '/library/import' in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-upload sidebar-item-icon"></i>
                <span class="sidebar-item-text">Import</span>
            </a>
            <a href="/library/artists" class="sidebar-item {% if '/library/artists' in request.url.path and '/import' not in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-user sidebar-item-icon"></i>
                <span class="sidebar-item-text">Artists</span>
            </a>
            <a href="/library/albums" class="sidebar-item {% if '/library/albums' in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-compact-disc sidebar-item-icon"></i>
                <span class="sidebar-item-text">Albums</span>
            </a>
            <a href="/library/tracks" class="sidebar-item {% if '/library/tracks' in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-music sidebar-item-icon"></i>
                <span class="sidebar-item-text">Tracks</span>
            </a>
        </div>

        <!-- Downloads Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">Downloads</div>
            <a href="/downloads" class="sidebar-item {% if '/downloads' in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-clock sidebar-item-icon"></i>
                <span class="sidebar-item-text">Queue</span>
                {% if queue_count is defined and queue_count and queue_count > 0 %}
                <span class="sidebar-item-badge">{{ queue_count }}</span>
                {% endif %}
            </a>
        </div>

        <!-- System Section -->
        <div class="sidebar-section">
            <div class="sidebar-section-title">System</div>
            <a href="/settings" class="sidebar-item {% if '/settings' in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-cog sidebar-item-icon"></i>
                <span class="sidebar-item-text">Settings</span>
            </a>
            <a href="/styleguide" class="sidebar-item {% if '/styleguide' in request.url.path %}active{% endif %}">
                <i class="fa-solid fa-palette sidebar-item-icon"></i>
                <span class="sidebar-item-text">Styleguide</span>
            </a>
        </div>
    </nav>

    <!-- Sidebar Footer -->
    <div class="sidebar-footer">
        <div class="sidebar-user">
            <img src="{{ user.avatar if user is defined and user and user.avatar else 'https://ui-avatars.com/api/?name=' ~ (user.name if user is defined and user and user.name else 'User') }}"
                alt="{{ user.name if user is defined and user and user.name else 'User' }}" class="sidebar-user-avatar">
            <div class="sidebar-user-info">
                <div class="sidebar-user-name">{{ user.name if user is defined and user and user.name else 'User' }}</div>
                <div class="sidebar-user-status">Online</div>
            </div>
        </div>
    </div>
</aside>
