{# 
  Hey future me - Skeleton Loading Components (updated for new design system)
  
  Use these when content is loading async. They match the new dark theme.
  Just slap skeleton-animate on the container if you want the shimmer effect.
#}

{# Card Skeleton #}
{% macro card_skeleton(count=3) %}
{% for i in range(count) %}
<div class="card" style="padding: var(--space-4);">
    <div class="skeleton-animate" style="height: 18px; width: 60%; border-radius: var(--radius-sm); margin-bottom: var(--space-3);"></div>
    <div class="skeleton-animate" style="height: 14px; width: 80%; border-radius: var(--radius-sm); margin-bottom: var(--space-2);"></div>
    <div class="skeleton-animate" style="height: 12px; width: 40%; border-radius: var(--radius-sm);"></div>
</div>
{% endfor %}
{% endmacro %}

{# List Item Skeleton #}
{% macro list_skeleton(count=5) %}
{% for i in range(count) %}
<div style="display: flex; align-items: center; gap: var(--space-4); padding: var(--space-4); background: var(--bg-secondary); border-radius: var(--radius-lg); margin-bottom: var(--space-3);">
    <div class="skeleton-animate" style="width: 48px; height: 48px; border-radius: var(--radius-md); flex-shrink: 0;"></div>
    <div style="flex: 1; display: flex; flex-direction: column; gap: var(--space-2);">
        <div class="skeleton-animate" style="height: 14px; width: 60%; border-radius: var(--radius-sm);"></div>
        <div class="skeleton-animate" style="height: 12px; width: 40%; border-radius: var(--radius-sm);"></div>
    </div>
</div>
{% endfor %}
{% endmacro %}

{# Stats Grid Skeleton (for dashboard stat cards) #}
{% macro stats_skeleton() %}
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4);">
    {% for i in range(4) %}
    <div class="stat-card">
        <div style="display: flex; flex-direction: column; gap: var(--space-3);">
            <div class="skeleton-animate" style="height: 12px; width: 33%; border-radius: var(--radius-sm);"></div>
            <div class="skeleton-animate" style="height: 32px; width: 50%; border-radius: var(--radius-sm);"></div>
        </div>
    </div>
    {% endfor %}
</div>
{% endmacro %}

{# Table Skeleton #}
{% macro table_skeleton(rows=5) %}
<div style="overflow-x: auto;">
    <table class="data-table">
        <thead>
            <tr>
                {% for i in range(4) %}
                <th>
                    <div class="skeleton-animate" style="height: 12px; width: 80px; border-radius: var(--radius-sm);"></div>
                </th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for i in range(rows) %}
            <tr>
                {% for j in range(4) %}
                <td>
                    <div class="skeleton-animate" style="height: 14px; width: {{ [60, 80, 70, 50][j % 4] }}%; border-radius: var(--radius-sm);"></div>
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endmacro %}

{# Media Card Skeleton (for playlists, albums, artists) #}
{% macro media_card_skeleton(count=6) %}
<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: var(--space-4);">
    {% for i in range(count) %}
    <div class="media-card">
        <div class="skeleton-animate" style="width: 100%; aspect-ratio: 1; border-radius: var(--radius-md);"></div>
        <div style="padding: var(--space-3); display: flex; flex-direction: column; gap: var(--space-2);">
            <div class="skeleton-animate" style="height: 14px; width: 70%; border-radius: var(--radius-sm);"></div>
            <div class="skeleton-animate" style="height: 12px; width: 50%; border-radius: var(--radius-sm);"></div>
        </div>
    </div>
    {% endfor %}
</div>
{% endmacro %}

{# Spinner - inline loading spinner #}
{% macro spinner(size='md', text='Loading...') %}
<div style="display: flex; align-items: center; gap: var(--space-2);">
    <i class="bi bi-arrow-repeat bi-spin" style="font-size: {% if size == 'sm' %}14px{% elif size == 'lg' %}28px{% else %}20px{% endif %}; color: var(--accent-primary);"></i>
    {% if text %}
    <span style="color: var(--text-muted); font-size: var(--font-size-sm);">{{ text }}</span>
    {% endif %}
</div>
{% endmacro %}

{# Loading Overlay - full element overlay #}
{% macro loading_overlay(message='') %}
<div class="loading-overlay" style="position: absolute; inset: 0; background: rgba(15, 15, 15, 0.8); display: flex; flex-direction: column; align-items: center; justify-content: center; gap: var(--space-4); z-index: 50; border-radius: inherit;">
    <i class="bi bi-arrow-repeat bi-spin" style="font-size: 32px; color: var(--accent-primary);"></i>
    {% if message %}
    <span style="color: var(--text-muted); font-size: var(--font-size-sm);">{{ message }}</span>
    {% endif %}
</div>
{% endmacro %}

{# Page Loading Skeleton (full page placeholder) #}
{% macro page_skeleton() %}
<div style="padding: var(--space-6);">
    {# Header skeleton #}
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-6);">
        <div style="display: flex; flex-direction: column; gap: var(--space-2);">
            <div class="skeleton-animate" style="height: 28px; width: 200px; border-radius: var(--radius-sm);"></div>
            <div class="skeleton-animate" style="height: 14px; width: 300px; border-radius: var(--radius-sm);"></div>
        </div>
        <div class="skeleton-animate" style="height: 40px; width: 120px; border-radius: var(--radius-md);"></div>
    </div>
    
    {# Stats skeleton #}
    {{ stats_skeleton() }}
    
    {# Content skeleton #}
    <div style="margin-top: var(--space-6);">
        {{ list_skeleton(5) }}
    </div>
</div>
{% endmacro %}

<style>
/* 
  Skeleton animation - adds a shimmer effect to placeholder elements
  Apply to any element you want to show as loading
*/
.skeleton-animate {
    background: linear-gradient(
        90deg,
        var(--bg-tertiary) 0%,
        rgba(255, 255, 255, 0.05) 50%,
        var(--bg-tertiary) 100%
    );
    background-size: 200% 100%;
    animation: skeleton-shimmer 1.5s ease-in-out infinite;
}

@keyframes skeleton-shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}
</style>
