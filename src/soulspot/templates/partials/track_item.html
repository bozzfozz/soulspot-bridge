{#
  Hey future me - Track Item Partial (HTMX fragment)
  
  Reusable track card for search results, playlists, etc.
  Uses new design system with inline styles matching CSS variables.
  Album art uses lazy loading for performance.
#}

<div class="card track-item" style="padding: var(--space-4);" data-track-id="{{ track.id }}">
    <div style="display: flex; gap: var(--space-4);">
        <!-- Album Art -->
        {% if track.album_art %}
        <img src="{{ track.album_art }}" 
             alt="Album art for {{ track.title }}"
             loading="lazy"
             style="width: 64px; height: 64px; border-radius: var(--radius-md); object-fit: cover; flex-shrink: 0;">
        {% else %}
        <div style="width: 64px; height: 64px; border-radius: var(--radius-md); background: var(--bg-tertiary); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
            <i class="fa-solid fa-music" style="font-size: 24px; color: var(--text-muted);"></i>
        </div>
        {% endif %}
        
        <!-- Track Info -->
        <div style="flex: 1; min-width: 0;">
            <h3 style="font-weight: var(--font-weight-semibold); color: var(--text-primary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                {{ track.title }}
            </h3>
            <p style="font-size: var(--font-size-sm); color: var(--text-muted); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                {{ track.artist }}
            </p>
            {% if track.album %}
            <p style="font-size: var(--font-size-xs); color: var(--text-muted); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; opacity: 0.7;">
                {{ track.album }}
            </p>
            {% endif %}
            
            <!-- Metadata -->
            <div style="display: flex; gap: var(--space-2); margin-top: var(--space-2); flex-wrap: wrap; align-items: center;">
                {% if track.duration %}
                <span style="font-size: var(--font-size-xs); color: var(--text-muted);">{{ track.duration }}</span>
                {% endif %}
                {% if track.quality %}
                <span class="badge badge-info">{{ track.quality }}</span>
                {% endif %}
                {% if track.year %}
                <span style="font-size: var(--font-size-xs); color: var(--text-muted);">{{ track.year }}</span>
                {% endif %}
            </div>
        </div>
        
        <!-- Actions -->
        <div style="display: flex; flex-direction: column; gap: var(--space-2); justify-content: center;">
            <button class="btn btn-primary btn-sm"
                    hx-post="/api/downloads"
                    hx-vals='{"track_id": "{{ track.id }}"}'
                    hx-swap="none"
                    hx-on::after-request="SoulSpot.toast('Track added to download queue', 'success')"
                    aria-label="Download {{ track.title }}">
                <i class="fa-solid fa-download"></i> Download
            </button>
            {% if show_details %}
            <button class="btn btn-outline btn-sm"
                    onclick="showTrackDetails('{{ track.id }}')"
                    aria-label="View details for {{ track.title }}">
                <i class="fa-solid fa-circle-info"></i> Details
            </button>
            {% endif %}
        </div>
    </div>
</div>
