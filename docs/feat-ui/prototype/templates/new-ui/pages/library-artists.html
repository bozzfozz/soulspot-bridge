{% extends "new-ui/base.html" %}

{% block title %}Artists - SoulSpot{% endblock %}

{% block content %}
{% import "new-ui/includes/macros.html" as macros %}

{% block content %}
<!-- Page Header -->
{% call macros.page_header(title="Artists", subtitle="Browse and manage your music artists") %}
<button class="btn btn-outline">
    <i class="fa-solid fa-filter"></i>
    Filters
</button>
<button class="btn btn-outline">
    <i class="fa-solid fa-sort"></i>
    Sort
</button>
<button class="btn btn-primary">
    <i class="fa-solid fa-plus"></i>
    Add Artist
</button>
{% endcall %}

<!-- Stats -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    {{ macros.stat_card("Total Artists", artists|length or 0, "fa-solid fa-user-music") }}
    {{ macros.stat_card("Total Albums", total_albums or 0, "fa-solid fa-compact-disc") }}
    {{ macros.stat_card("Total Tracks", total_tracks or 0, "fa-solid fa-music") }}
    {{ macros.stat_card("Following", following_count or 0, "fa-solid fa-star") }}
</div>

<!-- Search Bar -->
<div class="card mb-6" style="padding: var(--space-4);">
    <div class="flex items-center gap-3">
        <i class="fa-solid fa-search" style="color: var(--text-muted);"></i>
        <input type="text" placeholder="Search artists..."
            style="flex: 1; background: transparent; border: none; outline: none; color: var(--text-primary); font-size: var(--font-size-base);"
            hx-get="/api/library/artists/search" hx-trigger="keyup changed delay:300ms" hx-target="#artists-grid">
    </div>
</div>

<!-- Artists Grid -->
<div id="artists-grid">
    {% if artists %}
    <div class="grid grid-cols-6">
        {% for artist in artists %}
        <a href="/library/artists/{{ artist.id }}" class="media-card">
            <div class="media-card-image">
                <img src="{{ artist.image_url or 'https://ui-avatars.com/api/?name=' + artist.name + '&size=300&background=fe4155&color=fff' }}"
                    alt="{{ artist.name }}" style="border-radius: 50%;">
                <div class="media-card-overlay">
                    <div class="media-card-actions">
                        <button class="btn-icon btn-primary"
                            onclick="event.preventDefault(); playArtist('{{ artist.id }}')">
                            <i class="fa-solid fa-play"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="media-card-content" style="text-align: center;">
                <div class="media-card-title">{{ artist.name }}</div>
                <div class="media-card-subtitle">{{ artist.genre or 'Unknown' }}</div>
                <div class="media-card-meta" style="justify-content: center;">
                    <span>{{ artist.album_count or 0 }} albums</span>
                    <span>â€¢</span>
                    <span>{{ artist.track_count or 0 }} tracks</span>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if total_pages > 1 %}
    <div class="flex items-center justify-center gap-2 mt-8">
        {% if page > 1 %}
        <a href="?page={{ page - 1 }}" class="btn btn-outline btn-sm">
            <i class="fa-solid fa-chevron-left"></i>
        </a>
        {% endif %}

        <span class="text-muted">Page {{ page }} of {{ total_pages }}</span>

        {% if page < total_pages %} <a href="?page={{ page + 1 }}" class="btn btn-outline btn-sm">
            <i class="fa-solid fa-chevron-right"></i>
            </a>
            {% endif %}
    </div>
    {% endif %}

    {% else %}
    <!-- Empty State -->
    <div class="card" style="text-align: center; padding: 4rem;">
        <i class="fa-solid fa-user-music" style="font-size: 4rem; color: var(--text-muted); margin-bottom: 1.5rem;"></i>
        <h2>No Artists Yet</h2>
        <p class="text-muted" style="margin-top: 0.5rem; margin-bottom: 2rem;">
            Start by importing playlists from Spotify or adding artists manually.
        </p>
        <div class="flex gap-3" style="justify-content: center;">
            <a href="/playlists/import" class="btn btn-primary">
                <i class="fa-solid fa-download"></i>
                Import from Spotify
            </a>
            <button class="btn btn-outline">
                <i class="fa-solid fa-plus"></i>
                Add Artist
            </button>
        </div>
    </div>
    {% endif %}
</div>

{% endblock %}

{% block extra_scripts %}
<script>
    function playArtist(artistId) {
        console.log('Playing artist:', artistId);
        // TODO: Implement play functionality
    }
</script>
{% endblock %}